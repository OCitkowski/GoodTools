//<Описание функции>

//Параметры:
//	НачалоПериода - <Дата> - <Якщо не задано Возврат Неопределено >
//	КонецПериода - <Дата> - <Якщо не задано то встановлюється ТекущаяДата() >
//	ТолькоРабочие - <Булево> - <Якщо не задано то встановлюється Истина >
// Возвращаемое значение: Количество дней
//	<Число> - <Количество дней в интервале>
Функция ДатыИнтервалКоличествоВДнях(НачалоПериода, КонецПериода = Неопределено, ТолькоРабочие = Истина) Экспорт
	
	Если НачалоПериода = Неопределено Тогда Возврат Неопределено КонецЕсли;
	
	Если КонецПериода = Неопределено Тогда
		КонецПериода = ТекущаяДата();
	КонецЕсли;
	
	Запрос = Новый Запрос();
	
	Запрос.Текст = "ВЫБРАТЬ
	|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ РегламентированныйПроизводственныйКалендарь.ДатаКалендаря) КАК КоличествоДней
	|ИЗ
	|	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
	|ГДЕ
	|	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода";
	
	Если ТолькоРабочие Тогда
		Запрос.Текст = Запрос.Текст + "
		|	И (РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Предпраздничный)
		|	ИЛИ РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Рабочий))";
	КонецЕсли;
	
	Запрос.УстановитьПараметр("НачалоПериода", НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода", КонецПериода);
	
	РезультатВыполненияЗапроса = Запрос.Выполнить();
	
	Если РезультатВыполненияЗапроса.Пустой() Тогда
		#Если Клиент тогда
			Предупреждение("Необходимо заполнение регистра сведений «РегламентированныйПроизводственныйКалендарь» для текущего года!");
			РегистрыСведений.РегламентированныйПроизводственныйКалендарь.ПолучитьФорму("Форма").ОткрытьМодально();
		#Иначе
			Возврат Неопределено;
		#КонецЕсли
	Иначе
		
		Результат = РезультатВыполненияЗапроса.Выгрузить();
		
		Возврат Результат[0].КоличествоДней
		
	КонецЕсли;
	
КонецФункции
